---

title: RXNFP - chemical reaction fingerprints

keywords: fastai
sidebar: home_sidebar

summary: "This library generates chemical reaction fingerprints from reaction SMILES"
description: "This library generates chemical reaction fingerprints from reaction SMILES"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For all installations, we recommend using <code>conda</code> to get the necessary <code>rdkit</code> and <code>tmap</code> dependencies:</p>
<h3 id="From-pypi">From pypi<a class="anchor-link" href="#From-pypi"> </a></h3><div class="highlight"><pre><span></span><span class="go">conda create -n rxnfp python=3.6 -y</span>
<span class="go">conda activate rxnfp</span>
<span class="go">conda install -c rdkit rdkit</span>
<span class="go">conda install -c tmap tmap</span>
<span class="go">pip install rxnfp</span>
</pre></div>
<h3 id="From-github">From github<a class="anchor-link" href="#From-github"> </a></h3><div class="highlight"><pre><span></span><span class="go">conda create -n rxnfp python=3.6 -y</span>
<span class="go">conda activate rxnfp</span>
<span class="go">conda install -c rdkit rdkit</span>
<span class="go">conda install -c tmap tmap</span>
<span class="go">pip install -e .</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2><p>Compute a fingerprint from a reaction SMILES
<code>python</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">rxnfp.transformer_fingerprints</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">RXNBERTFingerprintGenerator</span><span class="p">,</span> <span class="n">get_default_model_and_tokenizer</span><span class="p">,</span> <span class="n">generate_fingerprints</span>
<span class="p">)</span>

<span class="n">model</span><span class="p">,</span> <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">get_default_model_and_tokenizer</span><span class="p">()</span>

<span class="n">rxnfp_generator</span> <span class="o">=</span> <span class="n">RXNBERTFingerprintGenerator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">)</span>

<span class="n">example_rxn</span> <span class="o">=</span> <span class="s2">&quot;Nc1cccc2cnccc12.O=C(O)c1cc([N+](=O)[O-])c(Sc2c(Cl)cncc2Cl)s1&gt;&gt;O=C(Nc1cccc2cnccc12)c1cc([N+](=O)[O-])c(Sc2c(Cl)cncc2Cl)s1&quot;</span>

<span class="n">fp</span> <span class="o">=</span> <span class="n">rxnfp_generator</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">example_rxn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fp</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>256
[-2.01749587059021, 1.7602041959762573, -1.332353949546814, -1.1095027923583984, 1.2254546880722046]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or for a list of reactions:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rxns</span> <span class="o">=</span> <span class="p">[</span><span class="n">example_rxn</span><span class="p">,</span> <span class="n">example_rxn</span><span class="p">]</span>
<span class="n">fps</span> <span class="o">=</span> <span class="n">rxnfp_generator</span><span class="o">.</span><span class="n">convert_batch</span><span class="p">(</span><span class="n">rxns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fps</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fps</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2 256
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reaction-Atlas">Reaction Atlas<a class="anchor-link" href="#Reaction-Atlas"> </a></h2><h3 id="Pistachio">Pistachio<a class="anchor-link" href="#Pistachio"> </a></h3><p>The fingerprints can be used to map the space of chemical reactions:</p>
<div style="text-align: center">
{% include image.html max-width="1000" file="/rxnfp/images/annotated_atlas.jpg" %}
<p style="text-align: center;"> <b>Figure:</b> Annotated Atlas of the Pistachio test set generated with TMAP (https://tmap.gdb.tools). </p>
</div><h3 id="Schneider-50k-set">Schneider 50k set<a class="anchor-link" href="#Schneider-50k-set"> </a></h3><p>In the notebooks, we show how to generate an interative reaction atlas for the Schneider 50k set. The end result is similar to this <strong><a href="https://rxn4chemistry.github.io/rxnfp//tmaps/tmap_ft_10k.html">interactive Reaction Atlas</a></strong>.</p>
<p>Where you will find different reaction properties highlighted in the different layers:</p>
<div style="text-align: center">
{% include image.html max-width="800" file="/rxnfp/images/tmap_properties.jpg" %}
<p style="text-align: center;"> <b>Figure:</b> Reaction atlas of 50k data set with different properties highlighted. </p>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Citation">Citation<a class="anchor-link" href="#Citation"> </a></h2><p>Our work was first presented in the NeurIPS 2019 workshop for <a href="https://ml4physicalsciences.github.io">Machine Learning and the Physical Sciences</a>, the most recent version can be found on [ChemRxiv](<a href="https://chemrxiv.org/articles/Data-Driven_Chemical_Reaction_Classification_with_Attention-Based_Neural_Networks/9897365">https://chemrxiv.org/articles/Data-Driven_Chemical_Reaction_Classification_with_Attention-Based_Neural_Networks/9897365</a></p>

<pre><code>@article{Schwaller2019rxnfp,
author = "Philippe Schwaller and Daniel Probst and Alain C. Vaucher and Vishnu H Nair and David Kreutter and Teodoro Laino and Jean-Louis Reymond",
title = "{Mapping the Space of Chemical Reactions using Attention-Based Neural Networks}",
year = "2019",
month = "9",
url = "https://chemrxiv.org/articles/preprint/Data-Driven_Chemical_Reaction_Classification_with_Attention-Based_Neural_Networks/9897365",
doi = "10.26434/chemrxiv.9897365.v3"
}</code></pre>
<p>RXNFP has been developed in a collaboration between IBM Research Europe and the <a href="http://gdb.unibe.ch">Reymond group</a> at the University of Bern. The classification models are used on the <a href="https://rxn.res.ibm.com">RXN for Chemistry</a> platform.</p>

</div>
</div>
</div>
</div>
 

